(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{426:function(t,s,n){"use strict";n.r(s);var a=n(2),r=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[t._v("现如今的前端领域，工程化尤为重要。前端不在局限于业务层、切图仔，也需要储备一定的运维相关的知识")]),t._v(" "),s("p",[t._v("转载："),s("a",{attrs:{href:"https://mp.weixin.qq.com/s/2-DIsGx9rKNxdRyYBFTv9w",target:"_blank",rel:"noopener noreferrer"}},[t._v("奇舞周刊第465期"),s("OutboundLink")],1)])]),s("h2",{attrs:{id:"npm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#npm"}},[t._v("#")]),t._v(" npm")]),t._v(" "),s("p",[s("strong",[t._v("npm 是 Node.js 官方提供的包管理工具，主要用来管理项目依赖，发布等等")])]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("nrm")]),t._v(" "),s("br"),t._v("\nnrm(npm registry manager )是npm的镜像源管理工具，因为npm默认建立的链接访问的是国外的资源，访问速度较慢，使用这个就可以快速地在 npm 源间切换"),s("br"),t._v("\nnrm 更多用于如果公司内网部署了私有仓库，也就是方便用nrm作来源切换，也有益于依赖的版本管理")])]),t._v(" "),s("ul",[s("li",[s("em",[s("strong",[t._v("安装")])]),t._v(" "),s("br")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm install -g nrm\n")])])]),s("ul",[s("li",[s("em",[s("strong",[t._v("查看可选的资源")])]),t._v(" "),s("br")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("nrm ls\nnpm ---------- https://registry.npmjs.org/\nyarn --------- https://registry.yarnpkg.com/\ntencent ------ https://mirrors.cloud.tencent.com/npm/\ncnpm --------- https://r.cnpmjs.org/\ntaobao ------- https://registry.npmmirror.com/       \nnpmMirror ---- https://skimdb.npmjs.com/registry/\n")])])]),s("ul",[s("li",[s("em",[s("strong",[t._v("添加私有仓库链接")])]),t._v(" "),s("br")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("nrm add name http://registry.npm.tree.com/  # 私有仓库链接\nnrm use name # 使用本址的镜像地址\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[s("strong",[t._v("发布npm包")]),t._v(" "),s("br")])]),t._v(" "),s("ul",[s("li",[s("em",[s("strong",[t._v("注册npm账号")])])]),t._v(" "),s("li",[s("em",[s("strong",[t._v("配置package.json")])])])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('{\n  "name": "kutil",\n  "version": "1.0.0", #版本名称\n  "scripts":[], # 可执行的脚本命令\n  "repository": "https://github.com/xxx/xxx.git", #github仓库地址\n  "author": "tree <shuxin_liu@kingdee.com>", #作者\n  "description": "工具包“, #包的说明\n  "keywords": [\n    "utils",\n  ]\n}\n')])])]),s("ul",[s("li",[s("em",[s("strong",[t._v("配置打包机制")])]),t._v(" "),s("br"),t._v("\n如果是工具类打包，推荐使用rollup，webpack比较适合打包一些应用，例如SPA或者同构项目")]),t._v(" "),s("li",[s("em",[s("strong",[t._v("添加单元测试")])]),t._v(" "),s("br"),t._v("\n优质的开源包，都有单元测试模块，来保证包的稳定性和代码质量，常见会有build-passing的标记，有兴趣的童鞋可以阅读树酱之前写的前端单元测试那些事")]),t._v(" "),s("li",[s("em",[s("strong",[t._v("开发文档readme.me")])]),t._v(" "),s("br"),t._v("\nreadme方便开发者快速熟悉，包括具体的Api介绍、使用例子、项目介绍等等，还可以加入包括单元测试覆盖率、下载量、证书等等")]),t._v(" "),s("li",[s("em",[s("strong",[t._v("发布")])]),t._v(" "),s("br")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("npm login # 登录你上面注册的npm账号\n\nnpm publish # 登录成功后，执行发布命令\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" kutil@"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),t._v(" # 发布成功显示npm包名及包的版本号\n")])])]),s("h2",{attrs:{id:"jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[t._v("#")]),t._v(" jenkins")]),t._v(" "),s("p",[s("strong",[t._v("jenkins作为一个可扩展的自动化服务器，可以用作简单的 CI 服务器，具有自动化构建、测试和部署等功能，简而言之，jenkins可以方便我们日常的前端项目版本更新迭代（开发、测试、生产环境等），也可以通过它自动化完成一系列的操作包括：编译打包元测试、代码扫描等，官方文档")])]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("如何安装")]),t._v(" "),s("ul",[s("li",[t._v("下载Jenkins")]),t._v(" "),s("li",[t._v("打开终端进入到下载目录")]),t._v(" "),s("li",[t._v("运行命令"),s("code",[t._v("java -jar jenkins.war --httpPort=8080")])]),t._v(" "),s("li",[t._v("打开浏览器进入链接 http://localhost:8080")]),t._v(" "),s("li",[t._v("按照说明完成安装")])])]),t._v(" "),s("li",[s("strong",[t._v("配合前端项目自动化部署")]),t._v(" "),s("br"),t._v("\n这里主要介绍jenkins流水线配置的使用，流水线的代码定义了整个的构建过程, 他通常包括构建, 测试和交付应用程序的阶段，下面是路径和仓库的配置\n"),s("img",{attrs:{src:"https://s1.ax1x.com/2023/02/13/pSIgBiF.png",alt:"流水线"}})])]),t._v(" "),s("p",[t._v("相关配置如下:")]),t._v(" "),s("ul",[s("li",[t._v("SCM:选择git或者svn作为代码触发器")]),t._v(" "),s("li",[t._v("脚本路径：在项目根目录创建jenkinsfile来编写流水线")])]),t._v(" "),s("p",[t._v("下面介绍一个简单版的jenkinsfile的流水线任务写法，完成整个前端工程化部署涉及的编译打包、静态扫描、单元测试等环节")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("def gitUrl "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://gitlab.****.com/shc/****.git"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GIT")]),t._v("入口（随不同工程改变）\ndef gitCred "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"***-***-4f00-a926-1848b670d97b"')]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//GIT 身份凭据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DEV"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" buildType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    buildScript "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build_development"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'k8s'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'下拉源码'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GitSCM'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("branches")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*/master'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("doGenerateSubmoduleConfigurations")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("extensions")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("submoduleCfg")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("userRemoteConfigs")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("credentialsId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${gitCred}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${gitUrl}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                 #可由片段生成器生成，选择示例步骤 “checkout"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("Check out from version control”，生成流水线脚本获取\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkStatus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'下拉源码'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'代码构建编译'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                sh "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn run ${buildScript}"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkStatus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'代码构建编译'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'代码静态扫描'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                sh "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yarn run lint'")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkStatus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'代码静态扫描'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'单元测试'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                 sh "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yarn run unit'")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkStatus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'单元测试'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Exception e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("完成后，即可构建项目，分阶段完成，首先是下拉源码、代码构建编译、代码扫描等等，所有环节成功才算自动化部署成功，如下所示\n"),s("img",{attrs:{src:"https://s1.ax1x.com/2023/02/13/pSI2ZYF.png",alt:"jenkins"}})]),t._v(" "),s("h2",{attrs:{id:"docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[t._v("#")]),t._v(" Docker")]),t._v(" "),s("p",[s("strong",[t._v("Docker是一个虚拟环境容器,可以将开发环境、代码、配置文件等一并打包到这个容器中,最后发布应用")])]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("如何使用")]),t._v(" "),s("br"),t._v("\n通过将部署的操作集中成一个部署脚本完成传统的部署流程，通过在服务器上运行docker容器来运行前端应用\n"),s("ul",[s("li",[t._v("安装")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("yum install docker-ce\n")])])])])]),t._v(" "),s("p",[t._v("项目目录，部署项目需要准备Dockerfile和nginx.conf(如果nginx不作定制化，可以直接用官方镜像)\n"),s("img",{attrs:{src:"https://s1.ax1x.com/2023/02/13/pSIRdCF.png",alt:"docker"}}),t._v("\n2. "),s("strong",[t._v("Dockerfile 配置")]),s("br"),t._v("\ndockerfile是一个配置文件,用来让docker build命令清楚运行那些操作，创建dockerfile并编写相关配置")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("FROM node:latest as builder \nWORKDIR /app\nCOPY package.json \nRUN npm install   \nCOPY . .\nRUN npm run build\n\n\nFROM nginx:latest\nCOPY nginx.conf /etc/nginx\nCOPY --from=builder /app/dist  /usr/share/nginx/html\n\n//ps: 每一个指令的前缀都必须是大写的。\n")])])]),s("ul",[s("li",[t._v("ADD和COPY：  将文件或目录复制到Dockerfile构建的镜像中")]),t._v(" "),s("li",[t._v("EXPOSE： 指定运行该镜像的容器使用的端口，可以是多个。")]),t._v(" "),s("li",[t._v("RUN ：指令告诉docker 在镜像内执行命令")]),t._v(" "),s("li",[t._v("FROM ：通过FROM指定的镜像名称，这个镜像称之为基础镜像，必须位于第一条非注释指令")]),t._v(" "),s("li",[t._v("WORKDIR： 在容器内部设置工作目录\nNginx.conf 配置如下")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("events {\n    worker_connections  1024;\n}\nhttp{\n    server {\n        listen       80;\n        server_name  localhost;\n        location / {\n            root   /usr/share/nginx/html;\n            index  index.html index.htm;\n        }   \n    }\n}\n")])])]),s("p",[t._v("创建文件并编写后，用docker创建镜像")]),t._v(" "),s("p",[t._v("详情请查看"),s("RouterLink",{attrs:{to:"/handbook/Docker.html"}},[t._v("前端Docker那些事")])],1),t._v(" "),s("h2",{attrs:{id:"nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[t._v("#")]),t._v(" Nginx")]),t._v(" "),s("p",[s("strong",[t._v("Nginx它既可以作为 Web 服务器，也可以作为负载均衡服务器，具备高性能、高并发连接等")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://imgse.com/i/pSooXUs",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://s1.ax1x.com/2023/02/14/pSooXUs.jpg",alt:"pSooXUs.jpg"}}),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("详情请查看"),s("RouterLink",{attrs:{to:"/handbook/Nginx.html"}},[t._v("前端Nginx那些事")])],1)])}),[],!1,null,null,null);s.default=r.exports}}]);